(()=>{var t={414:function(t){t.exports=function(){"use strict";var t=function(){var e=0,i=document.createElement("div");function n(t){return i.appendChild(t.dom),t}function a(t){for(var n=0;n<i.children.length;n++)i.children[n].style.display=n===t?"block":"none";e=t}i.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",i.addEventListener("click",(function(t){t.preventDefault(),a(++e%i.children.length)}),!1);var s=(performance||Date).now(),o=s,l=0,r=n(new t.Panel("FPS","#0ff","#002")),d=n(new t.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var c=n(new t.Panel("MB","#f08","#201"));return a(0),{REVISION:16,dom:i,addPanel:n,showPanel:a,begin:function(){s=(performance||Date).now()},end:function(){l++;var t=(performance||Date).now();if(d.update(t-s,200),o+1e3<=t&&(r.update(1e3*l/(t-o),100),o=t,l=0,c)){var e=performance.memory;c.update(e.usedJSHeapSize/1048576,e.jsHeapSizeLimit/1048576)}return t},update:function(){s=this.end()},domElement:i,setMode:a}};return t.Panel=function(t,e,i){var n=1/0,a=0,s=Math.round,o=s(window.devicePixelRatio||1),l=80*o,r=48*o,d=3*o,c=2*o,h=3*o,u=15*o,m=74*o,p=30*o,f=document.createElement("canvas");f.width=l,f.height=r,f.style.cssText="width:80px;height:48px";var y=f.getContext("2d");return y.font="bold "+9*o+"px Helvetica,Arial,sans-serif",y.textBaseline="top",y.fillStyle=i,y.fillRect(0,0,l,r),y.fillStyle=e,y.fillText(t,d,c),y.fillRect(h,u,m,p),y.fillStyle=i,y.globalAlpha=.9,y.fillRect(h,u,m,p),{dom:f,update:function(r,v){n=Math.min(n,r),a=Math.max(a,r),y.fillStyle=i,y.globalAlpha=1,y.fillRect(0,0,l,u),y.fillStyle=e,y.fillText(s(r)+" "+t+" ("+s(n)+"-"+s(a)+")",d,c),y.drawImage(f,h+o,u,m-o,p,h,u,m-o,p),y.fillRect(h+m-o,u,o,p),y.fillStyle=i,y.globalAlpha=.9,y.fillRect(h+m-o,u,o,s((1-r/v)*p))}}},t}()}},e={};function i(n){var a=e[n];if(void 0!==a)return a.exports;var s=e[n]={exports:{}};return t[n].call(s.exports,s,s.exports,i),s.exports}i.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return i.d(e,{a:e}),e},i.d=(t,e)=>{for(var n in e)i.o(e,n)&&!i.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},i.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{"use strict";const t="arError",e="mindar-location-system",n="location-initialized",a="location-camera-initialized";Math.PI,Math.PI,AFRAME.registerComponent("mindar-location",{dependencies:[e],el:null,schema:{showStats:{type:"boolean",default:!1},autoStart:{type:"boolean",default:!0},uiLoading:{type:"string",default:"yes"},uiScanning:{type:"string",default:"yes"},uiError:{type:"string",default:"yes"}},init:function(){const t=this.el.sceneEl.systems["mindar-location-system"];t.setup({uiLoading:this.data.uiLoading,uiScanning:this.data.uiScanning,uiError:this.data.uiError,showStats:this.data.showStats}),this.data.autoStart&&this.el.sceneEl.addEventListener("renderstart",(()=>{t.start()}))}}),AFRAME.registerComponent("mindar-location-camera",{dependencies:[e],arSystem:null,el:null,schema:{shouldFaceUser:{type:"boolean",default:!1},simulateAltitude:{type:"number",default:0},simulateLatitude:{type:"number",default:0},simulateLongitude:{type:"number",default:0},positionMinAccuracy:{type:"int",default:100},minDistance:{type:"int",default:0},maxDistance:{type:"int",default:0},gpsMinDistance:{type:"number",default:3},gpsTimeInterval:{type:"number",default:3}},init:function(){const t=this.el.sceneEl.systems["mindar-location-system"];this.arSystem=t,this.el.sceneEl.addEventListener(n,this.setup.bind(this))},tick:function(){this.arSystem&&this.arSystem.controller&&null!=(null===this.arSystem.controller.camera.heading)&&this.arSystem.controller.updateRotation()},setup:function(){this.arSystem.setupCamera({...this.data,camera:this.el}),console.log("Location camera initialized"),this.el.sceneEl.removeEventListener(n,this.setup)}}),AFRAME.registerComponent("mindar-location-place",{dependencies:[e],el:null,schema:{longitude:{type:"number",default:0},latitude:{type:"number",default:0},placeIndex:{type:"number"},minDistance:{type:"number",default:-1},maxDistance:{type:"number",default:-1}},init:function(){this.data.minDistance=Math.max(-1,this.data.minDistance),this.data.maxDistance=Math.max(-1,this.data.maxDistance),this.el.sceneEl.addEventListener(a,this.setup.bind(this)),this.el.sceneEl.addEventListener("location-objectFound",this.onLocationFound.bind(this)),this.el.sceneEl.addEventListener("location-objectLost",this.onLocationLost.bind(this))},setup:function(){this.el.sceneEl.systems["mindar-location-system"].addLocation({...this.data,location:this.el}),console.log("Location place added"),this.el.sceneEl.removeEventListener(a,this.setup)},onLocationFound:function(t){t.detail.placeIndex===this.data.placeIndex&&console.log(t.detail)},onLocationLost:function(t){t.detail.placeIndex===this.data.placeIndex&&console.log(t.detail)}});var s=i(414),o=i.n(s);const{Controller:l,UI:r}=window.MINDAR.LOCATION;AFRAME.registerSystem(e,{container:null,video:null,el:null,showStats:!1,controller:null,mainStats:null,ui:null,sytemState:"location-initializing",shouldFaceUser:!1,isEmulated:!1,setup:function({showStats:t,uiLoading:e,uiScanning:i,uiError:a}){this.showStats=t,this.ui=new r({uiLoading:e,uiScanning:i,uiError:a}),this.controller=new l,this.el.emit(n)},setupCamera:function(t){this.controller&&(this.controller.camera||(this.el.emit("location-camera-initializing"),this.controller.setupCamera(t),this.isEmulated=0!==t.simulateLatitude&&0!==t.simulateLongitude,this.el.emit(a)))},addLocation:function(t){this.controller&&this.controller.addLocation(t)},start:function(){this.container=this.el.sceneEl.parentNode,this.showStats&&(this.mainStats=new(o()),this.mainStats.showPanel(0),this.mainStats.domElement.style.cssText="position: absolute; top: 0px; left: 0px; z-index: 999",this.container.appendChild(this.mainStats.domElement)),this.ui.showLoading(),this._startVideo()},_startVideo:async function(){if(this.video=document.createElement("video"),this.video.setAttribute("autoplay",""),this.video.setAttribute("muted",""),this.video.setAttribute("playsinline",""),this.video.style.position="absolute",this.video.style.top="0px",this.video.style.left="0px",this.video.style.zIndex="-2",this.container.appendChild(this.video),!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)return this.el.emit(t,{error:"VIDEO_FAIL"}),void this.ui.showCompatibility();try{const t=(await navigator.mediaDevices.enumerateDevices()).filter((t=>"videoinput"===t.kind));let e="environment";t.length>1&&(e=this.shouldFaceUser?"user":"environment");const i=await navigator.mediaDevices.getUserMedia({audio:!1,video:{facingMode:e}});this.video.addEventListener("loadedmetadata",(()=>{this.video.setAttribute("width",this.video.videoWidth.toString()),this.video.setAttribute("height",this.video.videoHeight.toString()),this._startAR()})),this.video.srcObject=i}catch(e){console.log("getUserMedia error",e),this.el.emit(t,{error:"VIDEO_FAIL"})}},_startAR:function(){this._resize(),window.addEventListener("resize",this._resize.bind(this)),this.el.emit("arReady"),this.controller.startAR(),this.ui.hideLoading()},_resize:function(){((t,e)=>{let i,n;const a=t.videoWidth/t.videoHeight;a>e.clientWidth/e.clientHeight?(n=e.clientHeight,i=n*a):(i=e.clientWidth,n=i/a),t.style.top=-(n-e.clientHeight)/2+"px",t.style.left=-(i-e.clientWidth)/2+"px",t.style.width=i+"px",t.style.height=n+"px"})(this.video,this.container);const t=this.container.getElementsByTagName("a-scene")[0];t.style.top=this.video.style.top,t.style.left=this.video.style.left,t.style.width=this.video.style.width,t.style.height=this.video.style.height},update:function(){this.isEmulated&&this.controller.camera.getEmulatedPosition()}})})()})();